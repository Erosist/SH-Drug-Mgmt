# .gitlab-ci.yml
# 针对你的“根目录Vue + backend/Flask”结构

stages:
  - test

# --- 后端测试任务 ---
test-backend:
  stage: test
  image: python:3.10
  
  before_script:
    - echo "Installing backend dependencies..."
    # 你的 'backend' 文件夹是对的，所以这行不变
    - cd backend 
    - pip install -r requirements.txt
    - pip install pytest pytest-flask pytest-mock

  script:
    - echo "Running backend tests..."
    - pytest

# --- 前端测试任务 ---
test-frontend:
  stage: test
  image: node:18
  
  before_script:
    - echo "Installing frontend dependencies..."
    # 你的 'package.json' 就在根目录，所以我们不 cd
    # (删掉了 'cd frontend' 这一行)
    - npm install # 这会直接在根目录运行，是正确的

  script:
    - echo "Running frontend tests..."
    - npm run test # 这也会在根目录运行